<html>
  <head>
	<title>Employee Login Form</title>
  </head>
  <body>
	<form id='loginForm' action="/login" method="post">
  	<!-- user input-->
  	Employee ID:<br>
  	<input type="text" name="emp_id" placeholder="Employee ID" required><br><br>
  	Password:<br>
  	<input type="password" name="password" placeholder="Password" required><br><br>
  	<!-- submit button -->
  	<input type="submit" value="login">
	</form>



<script>document.forms['loginForm'].addEventListener('submit', (event) => {
    event.preventDefault();
    // TODO do something here to show user that form is being submitted
    fetch(event.target.action, {
        method: 'POST',
        body: new URLSearchParams(new FormData(event.target)) // event.target is the form
    }).then((resp) => {
        return resp.json(); // or resp.text() or whatever the server sends
    }).then((body) => {
        // TODO handle body
		console.log(body)
		console.log(body.token)
		const jwt= body.token

		fetch("/view",{
			headers:{
				Authorization: `Bearer ${body.token}`,
				'Content-Type': 'application/json'
			},
			method: "POST",
			body: JSON.stringify({
				"emp_id": 1234,
				"tts_code":"TRG"
			})
		}).then(res=> res.json()).then(data=>{
				console.log(data)
			}).catch(err=> console.error(err))
		}).catch(er=>{
        // TODO handle error
		console.error(error)
    });
})

</script>

  </body>
</html>